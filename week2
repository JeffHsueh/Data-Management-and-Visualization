# Course: Data Management and Visualization
# Week2
#Editor: Kuo-Lin Hsueh
import pandas as pd
import numpy as np

df = pd.read_csv("gapminder.csv", low_memory = False)
df["incomeperperson"] = df["incomeperperson"].convert_objects(convert_numeric=True)
df["femaleemployrate"] = df["femaleemployrate"].convert_objects(convert_numeric=True)

# mean for incomeperperson excluding missing data
mean_ipp = (df["incomeperperson"].mean(skipna=True)) 

country_abovemean = df.loc[df["incomeperperson"] >= mean_ipp]
country_belowmean = df.loc[df["incomeperperson"] < mean_ipp]


##################Counts & percentage##################

# counts for countries having greater income/person than the average
print ("Counts for countries that have income per person greater than average:",
       len(country_abovemean['country']),"counts")  

#print (country_abovemean[['country','incomeperperson', 'femaleemployrate', 'polityscore']]) # Show data according to the countries
print ("Percentage for countries that have income per person greater than average:")
print (len(country_abovemean)/ len(df)) # percentage

# counts for countries having less income/person than the average
print ("Counts for countries that have income per person less than average:",
       len(country_belowmean['country']), "counts") 

#print (country_belowmean[['country','incomeperperson', 'femaleemployrate', 'polityscore']]) # Show data according to the countries
print ("Percentage for countries that have income per person less than average:")
print (len(country_belowmean)/ len(df)) # percentage


##I decide to exclude countries missing value in incomeperperson.  
